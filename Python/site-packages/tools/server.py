#!/usr/bin/env python
# -*- coding: utf-8 -*-

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# Some operations on servers
#
#
# Authors: Hao BAI
# Date: 02/11/2018
#
# Version:
#   - 0.0: Initial version
#   
# Comments:
# 
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



#!----------------------------------------------------------------------------------------
#!                                          MODULES PRÉREQUIS
#!----------------------------------------------------------------------------------------
#*============================== Modules Personnels ==============================
from tools import utils, gmail
#*============================== Modules Communs ==============================
import glob



#!----------------------------------------------------------------------------------------
#!                                         CLASS
#!----------------------------------------------------------------------------------------
class Aster1(object):
    ''' aster1 server
        *ATTRIBUTES*
            nodes:
        *METHODS*
            get():
    '''
    def __init__(self, path, echo):
        self.path = path
        self.echo = echo
        self.list_filename = []
        self.seeds = []

        self._getFilelist()
        self._convertToSeed()

    def _getFilelist(self):
        with utils.cd(self.path):
            self.list_filename = glob.glob('*.bts')
            if self.list_filename == []:
                gmail.send_mail('hao.bai@insa-rouen.fr')

    def _convertToSeed(self):
        for filename in self.list_filename:
            filebase = filename.rstrip('.bts')
            seed = filebase.split('_')
            if len(seed) < 3: continue
            seed[1] = seed[1].rstrip('mps')
            self.seeds.append(seed)

    def run(self, function, *args):
        if len(args) == 0: function(self.seeds)
        if len(args) == 1: function(self.seeds, args[0])
        if len(args) == 2: function(self.seeds, args[0], args[1])
        if len(args) == 3: function(self.seeds, args[0], args[1], args[2])
        if len(args) == 4: function(self.seeds, args[0], args[1], args[2], args[3])

#!----------------------------------------------------------------------------------------
#!                                      FUNCTIONS
#!----------------------------------------------------------------------------------------
def testFunction():
    pass



#!----------------------------------------------------------------------------------------
#!                                     MAIN FUNCTION
#!----------------------------------------------------------------------------------------
def main():
    pass



#!----------------------------------------------------------------------------------------
#!                                         EXÉCUTION
#!----------------------------------------------------------------------------------------
if __name__ == '__main__':
    main()
